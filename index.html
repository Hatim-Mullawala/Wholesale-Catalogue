<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wholesale Catalogue - Hatimi Hardware</title>
    <style>
        :root { --primary-gold: #b38728; --dark-bg: #333; }
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; padding: 0; background-color: #f4f7f6; color: #333; }

        .search-container { background: white; padding: 15px 0; display: flex; justify-content: center; border-bottom: 1px solid #ddd; position: sticky; top: 0; z-index: 1000; }
        .search-box { width: 60%; max-width: 700px; padding: 12px 25px; border: 1.5px solid var(--primary-gold); border-radius: 50px; font-size: 16px; outline: none; }

        .main-wrapper { max-width: 1300px; margin: 20px auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 25px rgba(0,0,0,0.06); }

        .catalog-header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 25px; border-bottom: 3px solid var(--primary-gold); margin-bottom: 30px; }
        .logo-section { display: flex; align-items: center; gap: 15px; }
        .logo-img { height: 75px; width: auto; }
        .brand-name { margin: 0; font-size: 34px; font-weight: 800; color: #b38728; text-transform: uppercase; line-height: 1; }
        .tagline { margin: 0; font-size: 17px; color: #444; font-weight: 700; }

        .action-buttons { display: flex; gap: 15px; }
        .icon-btn { 
            background: white; border: 1px solid #f0f0f0; border-radius: 50%; 
            width: 50px; height: 50px; cursor: pointer; 
            display: flex; align-items: center; justify-content: center; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.08); transition: 0.3s;
        }

        .category-header { background: #333; color: #fff; padding: 14px 20px; font-size: 15px; font-weight: bold; text-transform: uppercase; margin-top: 40px; border-left: 10px solid var(--primary-gold); border-radius: 5px 5px 0 0; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(230px, 1fr)); gap: 25px; padding: 25px; border: 1px solid #eee; border-top: none; margin-bottom: 30px; border-radius: 0 0 10px 10px; }
        
        .product-card { background: white; border: 1.5px solid #efefef; border-radius: 12px; padding: 20px; text-align: center; display: flex; flex-direction: column; height: auto; transition: 0.3s; }
        .img-holder { height: 160px; margin-bottom: 20px; display: flex; align-items: center; justify-content: center; }
        .img-holder img { max-height: 100%; max-width: 100%; object-fit: contain; }

        .p-brand { color: var(--primary-gold); font-size: 11px; font-weight: 900; text-transform: uppercase; margin-bottom: 8px; }
        .p-name { font-size: 19px; font-weight: 800; color: #222; margin-bottom: 12px; min-height: 44px; display: flex; align-items: center; justify-content: center; }
        .p-specs { font-size: 14px; color: #555; font-weight: 600; margin-bottom: 25px; flex-grow: 1; display: flex; align-items: center; justify-content: center; line-height: 1.5; min-height: 40px; word-break: break-word; }

        .btn-request { border: 1.5px solid #d4af37; color: #8c6d12; background: white; padding: 10px; border-radius: 6px; font-weight: 700; text-decoration: none; text-transform: uppercase; font-size: 11px; }

        /* BACK TO TOP BUTTON STYLES */
        #backToTop {
            display: none; position: fixed; bottom: 30px; right: 30px; z-index: 1001;
            background-color: white; color: var(--primary-gold); border: 2px solid var(--primary-gold);
            width: 50px; height: 50px; border-radius: 50%; font-size: 24px; cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: 0.3s; align-items: center; justify-content: center;
        }
        #backToTop:hover { background-color: var(--primary-gold); color: white; }

        /* FOOTER STYLES */
        footer { background: white; padding: 60px 20px 30px; border-top: 4px solid var(--primary-gold); margin-top: 80px; }
        .footer-container { max-width: 1200px; margin: 0 auto; display: grid; grid-template-columns: repeat(3, 1fr); gap: 40px; }
        .footer-column h3 { color: var(--primary-gold); font-size: 16px; font-weight: 800; text-transform: uppercase; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .footer-column p, .footer-column div { font-size: 14px; line-height: 1.8; color: #333; margin: 0; }
        .footer-column strong { font-weight: 700; display: inline-block; width: 65px; }
        .btn-whatsapp-footer { background-color: #25d366; color: white; text-decoration: none; padding: 12px 25px; border-radius: 50px; display: inline-block; font-weight: bold; font-size: 16px; margin-top: 20px; box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3); }
        .last-sync { text-align: center; color: var(--primary-gold); font-size: 12px; font-weight: 800; margin-top: 50px; text-transform: uppercase; letter-spacing: 1px; }
        .copyright-text { text-align: center; font-size: 12px; color: #888; margin-top: 15px; }

        .print-only-table { display: none; }

        @media (max-width: 768px) {
            .main-wrapper { padding: 15px; margin: 10px; }
            .catalog-header { flex-direction: column; text-align: center; gap: 15px; }
            .logo-section { flex-direction: column; }
            .brand-name { font-size: 24px; }
            .product-grid { grid-template-columns: repeat(2, 1fr) !important; gap: 10px; padding: 10px; }
            .footer-container { grid-template-columns: 1fr; gap: 30px; }
            #backToTop { bottom: 20px; right: 20px; width: 45px; height: 45px; }
        }

        @media print {
            /* MINIMIZE TOP AND BOTTOM MARGINS */
            @page { 
                margin: 0.4cm 1cm 0.4cm 1cm; /* Top, Right, Bottom, Left */
            }

            .search-container, .action-buttons, .btn-request, .main-wrapper, #backToTop { display: none !important; }
            .print-only-table { display: table !important; width: 100%; border-collapse: collapse; }
            thead { display: table-header-group; }
            body { background: white; margin: 0; padding: 0; }
            
            /* TIGHTER HEADER */
           header.catalog-header { 
        display: flex !important;
        flex-direction: row !important; /* Forces side-by-side */
        justify-content: flex-start !important; 
        align-items: center !important;
        padding: 5px 0 !important;
        gap: 15px !important;
    }

    .logo-section { 
        flex-direction: row !important; 
        gap: 15px !important;
    }
            .logo-img { height: 40px !important; } 
            .brand-name { 
        font-size: 22px !important; 
        white-space: nowrap; /* Prevents name from wrapping to a second line */
    }
    .tagline { 
        font-size: 11px !important; 
        margin-left: 10px !important;
        display: inline-block !important; /* Keeps tagline on the same line if space permits */
    }

            /* COMPACT GRID AND CARDS */
            .product-grid { 
                display: grid !important; 
                grid-template-columns: repeat(4, 1fr) !important; 
                gap: 4px !important; 
                padding: 0 !important; 
            }
            
            .product-card { 
                border: 1px solid #ddd !important; 
                padding: 5px !important; 
                height: auto !important; 
                break-inside: avoid;
            }
            
            .img-holder { height: 75px !important; margin-bottom: 3px !important; }
            .p-name { font-size: 10px !important; line-height: 1.1; }
            
            /* TIGHTER FOOTER FOR LOWER MARGIN */
            footer { 
                display: block !important; 
                border-top: 1px solid var(--primary-gold); 
                margin-top: 10px !important; 
                padding: 10px 0 !important; /* Reduced padding to save lower space */
                page-break-inside: avoid; 
            }
            .footer-container { gap: 15px !important; }
            .footer-column h3 { margin-bottom: 5px !important; font-size: 10px !important; }
            .last-sync, .copyright-text { margin-top: 5px !important; font-size: 8px !important; }
        }
    </style>
</head>
<body>

<div class="search-container">
    <input type="text" id="searchInput" class="search-box" placeholder="Search product or brand..." onkeyup="filterProducts()">
</div>

<div class="main-wrapper">
    <header class="catalog-header">
        <div class="logo-section">
            <img src="logo.png" class="logo-img" alt="Logo" onerror="this.src='https://via.placeholder.com/80'">
            <div>
                <h1 class="brand-name">Hatimi Hardware</h1>
                <p class="tagline">Quality Fittings ‚Ä¢ Trusted Tools</p>
            </div>
        </div>
        <div class="action-buttons">
            <button class="icon-btn" onclick="location.reload()" title="Refresh">
                <svg width="22" height="22" viewBox="0 0 24 24"><path fill="#b38728" d="M12,18A6,6 0 0,1 6,12C6,11 6.25,10.03 6.7,9.2L5.24,7.74C4.46,8.97 4,10.43 4,12A8,8 0 0,0 12,20V23L16,19L12,15V18M12,4V1L8,5L12,9V6A6,6 0 0,1 18,12C18,13 17.75,13.97 17.3,14.8L18.76,16.26C19.54,15.03 20,13.57 20,12A8,8 0 0,0 12,4Z"/></svg>
            </button>
            <button class="icon-btn" onclick="window.print()" title="Print">
                <svg width="22" height="22" viewBox="0 0 24 24"><path fill="#b38728" d="M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z"/></svg>
            </button>
        </div>
    </header>

    <div id="catalog-container">
        <p style="text-align:center; padding: 50px;">Syncing Wholesale Catalogue...</p>
    </div>
</div>

<button id="backToTop" onclick="scrollToTop()" title="Go to top">‚Üë</button>

<table class="print-only-table">
   <thead>
    <tr>
        <td>
            <header class="catalog-header" style="display: flex; align-items: center; border-bottom: 2px solid #b38728; padding: 10px 0; gap: 15px;">
                <img src="logo.png" class="logo-img" style="height: 50px; width: auto;" alt="Logo">
                <div style="display: flex; flex-direction: column; justify-content: center;">
                    <h1 style="margin:0; font-size: 22px; color: #b38728; text-transform: uppercase;">Hatimi Hardware</h1>
                    <p style="margin:0; font-size: 11px; color: #444;">Quality Fittings ‚Ä¢ Trusted Tools</p>
                </div>
            </header>
        </td>
    </tr>
</thead>
    <tbody>
        <tr><td><div id="print-catalog-container"></div></td></tr>
    </tbody>
</table>

<footer>
    <div class="footer-container">
        <div class="footer-column">
            <h3>üìç VISIT OUR SHOP</h3>
            <p><strong>Hatimi Hardware</strong><br>
            101, Subhash Path, Opp. Madhur Courier<br>
            Barnagar, MP - 456771</p>
        </div>
        <div class="footer-column">
            <h3>üìû CONTACT DETAILS</h3>
            <div><strong>Juzer:</strong> 94066 48766</div>
            <div><strong>Shabbir:</strong> 94254 94845</div>
            <div><strong>Murtaza:</strong> 81090 15951</div>
        </div>
        <div class="footer-column">
            <h3>üì© SUPPORT & ORDERS</h3>
            <p><strong>Email:</strong> hussain22juzer@gmail.com</p>
            <a href="https://wa.me/919406648766" class="btn-whatsapp-footer">Order on WhatsApp</a>
        </div>
    </div>
    <div class="last-sync">LAST SYNC: <span id="sync-time"></span></div>
    <div class="copyright-text">¬© 2026 Hatimi Hardware. All Rights Reserved.</div>
</footer>

<script>
    const sheetURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRqfLPTM9QCajpUToFw0B2UTKUIv-0d3P5ldQxLWKYfD98PPVf5ZEDXITZuTrdNPh8D8dDKcJxO1D4O/pub?gid=897547923&single=true&output=csv';
    let allProducts = [];

    // BACK TO TOP LOGIC
    window.onscroll = function() {
        const btn = document.getElementById("backToTop");
        if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
            btn.style.display = "flex";
        } else {
            btn.style.display = "none";
        }
    };

    function scrollToTop() {
        window.scrollTo({top: 0, behavior: 'smooth'});
    }

    function parseCSVLine(line) {
        const result = [];
        let cell = '';
        let inQuotes = false;
        for (let i = 0; i < line.length; i++) {
            const char = line[i];
            if (char === '"' && line[i+1] === '"') { cell += '"'; i++; }
            else if (char === '"') { inQuotes = !inQuotes; }
            else if (char === ',' && !inQuotes) { result.push(cell.trim()); cell = ''; }
            else { cell += char; }
        }
        result.push(cell.trim());
        return result;
    }

    async function loadData() {
        try {
            const response = await fetch(sheetURL);
            const data = await response.text();
            const rows = data.split('\n').filter(r => r.trim() !== '').slice(1);
            allProducts = rows.map(row => {
                const cols = parseCSVLine(row); 
                return { cat: cols[0] || 'Uncategorized', brand: cols[1] || '', name: cols[2] || '', specs: cols[3] || '', key: cols[4] || '' };
            });
            allProducts.sort((a, b) => a.cat.localeCompare(b.cat) || a.name.localeCompare(b.name));
            renderGrid(allProducts);
            document.getElementById('sync-time').innerText = new Date().toLocaleString();
        } catch (e) { document.getElementById('catalog-container').innerHTML = "Error loading data."; }
    }

    function renderGrid(products) {
    const screen = document.getElementById('catalog-container');
    const print = document.getElementById('print-catalog-container');
    let currentCat = "", html = "";

    products.forEach(p => {
        if (p.cat !== currentCat) {
            if (html !== "") html += `</div>`;
            currentCat = p.cat;
            html += `<div class="category-header">${currentCat}</div><div class="product-grid">`;
        }

        // The exact cleaning logic from your working 222-line file
        const clean = (t) => (t || '').toString().toLowerCase().trim()
            .replace(/["']/g, '')       
            .replace(/[,\s./_]+/g, '-') 
            .replace(/-+/g, '-')        
            .replace(/^-|-$/g, '');

        const b = clean(p.brand);
        const n = clean(p.name);
        const s = clean(p.specs);
        const k = clean(p.key);
        
        // Step-by-step fallback logic
        html += `
            <div class="product-card">
                <div class="img-holder">
                    <img src="wholesale/${b}-${n}-${s}.jpg" 
                         onerror="this.src='wholesale/${b}-${n}.jpg'; this.onerror=function(){this.src='wholesale/${n}.jpg'; this.onerror=function(){this.src='wholesale/${k}.jpg'; this.onerror=function(){this.src='https://via.placeholder.com/150?text=Photo+Coming+Soon'};}}">
                </div>
                <div class="p-brand">${p.brand}</div>
                <div class="p-name">${p.name}</div>
                <div class="p-specs">${p.specs}</div>
                <a href="https://wa.me/919406648766" class="btn-request">Request Price</a>
            </div>`;
    });
    screen.innerHTML = html + "</div>";
    print.innerHTML = html + "</div>";
}
    function filterProducts() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const filtered = allProducts.filter(p => p.name.toLowerCase().includes(term) || p.brand.toLowerCase().includes(term));
        renderGrid(filtered);
    }
    loadData();
</script>
</body>
</html>